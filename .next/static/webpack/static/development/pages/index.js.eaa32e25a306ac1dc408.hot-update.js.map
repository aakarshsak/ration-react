{"version":3,"file":"static/webpack/static/development/pages/index.js.eaa32e25a306ac1dc408.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["import React, {Component} from 'react';\nimport { Card, Button } from 'semantic-ui-react';\nimport factory from '../ethereum/factory';\nimport Layout from '../components/layout';\nimport { Link } from '../routes';\nimport get from '../localmodules/express_get';\nimport validate from '../localmodules/token_validate';\nimport Shop from '../ethereum/shop';\nimport web3 from '../ethereum/web3';\n// import jsonArray from '../localmodules/data_initialization';\n\nclass App extends Component {\n    \n    static async getInitialProps(props) {\n        //const accounts = await web3.eth.getAccounts();\n        //console.log('Accounts', accounts);\n        const shops = await factory.methods.getDeployedShops().call();\n        let shopList = [];\n        for(let i=0;i<shops.length;i++){\n            const s = Shop(shops[i]);\n            const details = await s.methods.getDetails().call();\n            const obj = {\n                details,\n                address : shops[i]\n            };\n            shopList.push(obj);\n        }\n        //console.log(shopList);\n        const { loggedIn, headerToken } = validate(props.query.headerToken);\n        return { shops, headerToken, loggedIn, shopList };\n    }\n\n\n    renderShops = () => {\n        const items = this.props.shopList.map((item) => {\n            return{\n                header : item.details[6],\n                description : <Link route={`/${validate(this.props.headerToken).headerToken}/shops/${item.address}`}><a>View Shops</a></Link>,\n                meta : item.details[8].substring(0,item.details[8].tolowerCase().indexOf(\"Chiknayakanhalli\".toLowerCase()))\n            };\n        });\n\n        return <Card.Group items={items} itemsPerRow={2}/>;\n    }\n\n    onClick = async (event) => {\n        event.preventDefault();\n        const headers = { \n                'Content-Type':'application/json',\n                'x-auth-token' : this.props.headerToken\n        };\n\n        const {data, status} = await get('/user/login/me', headers);\n        console.log(data);\n        console.log(status);\n    }\n\n    render() {\n        return (\n            <Layout loggedIn={this.props.loggedIn} headerToken={this.props.headerToken}>\n                <div>\n                    {this.renderShops()}\n                    <Button\n                        onClick={this.onClick}\n                        content=\"Create Shops\"\n                        icon=\"add circle\"\n                        primary\n                    />\n                </div>\n            </Layout>\n        );\n\n    }\n\n}\n\nexport default App;\n\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAHA;AAKA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAAA;AACA;AADA;AAAA;AAOA;AAAA;AACA;AACA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;AAWA;AACA;AACA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AAJA;AAUA;;;AA3DA;;;;;;;;AAGA;AACA;;AADA;AACA;AACA;AACA;;AADA;;;;;AACA;;AACA;AACA;;AADA;AACA;AACA;AACA;AAFA;AAIA;AACA;;AARA;;;;;AASA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;AAnBA;AACA;AAgEA;;;;A","sourceRoot":""}