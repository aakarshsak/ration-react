{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from 'react';\nimport { Card, Button } from 'semantic-ui-react';\nimport factory from '../ethereum/factory';\nimport Layout from '../components/layout';\nimport { Link } from '../routes';\nimport get from '../localmodules/express_get';\nimport validate from '../localmodules/token_validate';\nimport Shop from '../ethereum/shop';\nimport '../localmodules/location/location_dropdown'; // import jsonArray from '../localmodules/data_initialization';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      user: null\n    });\n\n    _defineProperty(this, \"getUserDetails\", async token => {\n      const headers = {\n        'Content-Type': 'application/json',\n        'x-auth-token': token\n      };\n\n      if (this.props.loggedIn) {\n        const {\n          data,\n          status\n        } = await get('/user/login/me', headers);\n        this.setState({\n          user: data\n        });\n      }\n    });\n\n    _defineProperty(this, \"renderShops\", () => {\n      const items = this.props.shopList.map(item => {\n        if (this.state.user.address.area !== item.blockName.toLowerCase()) return {\n          header: item.details[6].toUpperCase(),\n          description: __jsx(Link, {\n            route: `/${validate(this.props.headerToken).headerToken}/shops/${item.address}`\n          }, __jsx(\"a\", null, \"View Shops\")),\n          meta: item.details[8].substring(0, item.details[8].toLowerCase().indexOf(\"Chiknayakanhalli\".toLowerCase()))\n        };\n      });\n      return __jsx(Card.Group, {\n        items: items,\n        itemsPerRow: 2\n      });\n    });\n\n    _defineProperty(this, \"onClick\", async event => {\n      event.preventDefault();\n      const headers = {\n        'Content-Type': 'application/json',\n        'x-auth-token': this.props.headerToken\n      };\n      const {\n        data,\n        status\n      } = await get('/user/login/me', headers);\n      console.log(data);\n      console.log(status);\n    });\n  }\n\n  static async getInitialProps(props) {\n    const shops = await factory.methods.getDeployedShops().call();\n    let shopList = [];\n\n    for (let i = 0; i < shops.length; i++) {\n      const s = Shop(shops[i]);\n      const details = await s.methods.getDetails().call();\n      const blockName = await s.methods.blockName().call();\n      const obj = {\n        details,\n        address: shops[i],\n        blockName\n      };\n      shopList.push(obj);\n    } //console.log(shopList);\n\n\n    const {\n      loggedIn,\n      headerToken\n    } = validate(props.query.headerToken);\n    return {\n      shops,\n      headerToken,\n      loggedIn,\n      shopList\n    };\n  }\n\n  componentDidMount() {\n    this.getUserDetails(this.props.headerToken);\n  }\n\n  render() {\n    return __jsx(Layout, {\n      loggedIn: this.props.loggedIn,\n      headerToken: this.props.headerToken\n    }, __jsx(\"div\", null, this.renderShops(), __jsx(Button, {\n      onClick: this.onClick,\n      content: \"Create Shops\",\n      icon: \"add circle\",\n      primary: true\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/zoro/Documents/Programming/JS/ration/ration-react/pages/index.js"],"names":["React","Component","Card","Button","factory","Layout","Link","get","validate","Shop","App","user","token","headers","props","loggedIn","data","status","setState","items","shopList","map","item","state","address","area","blockName","toLowerCase","header","details","toUpperCase","description","headerToken","meta","substring","indexOf","event","preventDefault","console","log","getInitialProps","shops","methods","getDeployedShops","call","i","length","s","getDetails","obj","push","query","componentDidMount","getUserDetails","render","renderShops","onClick"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport { Card, Button } from 'semantic-ui-react';\nimport factory from '../ethereum/factory';\nimport Layout from '../components/layout';\nimport { Link } from '../routes';\nimport get from '../localmodules/express_get';\nimport validate from '../localmodules/token_validate';\nimport Shop from '../ethereum/shop';\nimport {  } from '../localmodules/location/location_dropdown';\n// import jsonArray from '../localmodules/data_initialization';\n\nclass App extends Component {\n    \n    state = { user : null };\n    static async getInitialProps(props) {\n\n        const shops = await factory.methods.getDeployedShops().call();\n        let shopList = [];\n        for(let i=0;i<shops.length;i++){\n            const s = Shop(shops[i]);\n            const details = await s.methods.getDetails().call();\n            const blockName = await s.methods.blockName().call();\n            const obj = {\n                details,\n                address : shops[i],\n                blockName\n            };\n            shopList.push(obj);\n        }\n        //console.log(shopList);\n        const { loggedIn, headerToken } = validate(props.query.headerToken);\n        return { shops, headerToken, loggedIn, shopList };\n    }\n\n    componentDidMount() {\n        this.getUserDetails(this.props.headerToken);\n    }\n\n    getUserDetails = async (token) => {\n        const headers = { 'Content-Type':'application/json', 'x-auth-token' : token};\n        if(this.props.loggedIn){\n            const {data, status} = await get('/user/login/me', headers);\n            this.setState({user : data});\n        }\n    }\n\n    renderShops = () => {\n        const items = this.props.shopList.map((item) => {\n            if(this.state.user.address.area !== item.blockName.toLowerCase())\n            return{\n                header : item.details[6].toUpperCase(),\n                description : <Link route={`/${validate(this.props.headerToken).headerToken}/shops/${item.address}`}><a>View Shops</a></Link>,\n                meta : item.details[8].substring(0,item.details[8].toLowerCase().indexOf(\"Chiknayakanhalli\".toLowerCase()))\n            };\n        });\n\n        return <Card.Group items={items} itemsPerRow={2}/>;\n    }\n\n    onClick = async (event) => {\n        event.preventDefault();\n        const headers = { \n                'Content-Type':'application/json',\n                'x-auth-token' : this.props.headerToken\n        };\n\n        const {data, status} = await get('/user/login/me', headers);\n        console.log(data);\n        console.log(status);\n    }\n\n    render() {\n        return (\n            <Layout loggedIn={this.props.loggedIn} headerToken={this.props.headerToken}>\n                <div>\n                    {this.renderShops()}\n                    <Button\n                        onClick={this.onClick}\n                        content=\"Create Shops\"\n                        icon=\"add circle\"\n                        primary\n                    />\n                </div>\n            </Layout>\n        );\n\n    }\n\n}\n\nexport default App;\n\n\n"]},"metadata":{},"sourceType":"module"}