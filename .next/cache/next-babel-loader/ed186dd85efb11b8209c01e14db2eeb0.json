{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport { Card, Button } from 'semantic-ui-react';\nimport factory from '../ethereum/factory';\nimport Layout from '../components/layout';\nimport { Link } from '../routes';\nimport get from '../localmodules/express_get';\nimport validate from '../localmodules/token_validate';\nimport Shop from '../ethereum/shop'; // import jsonArray from '../localmodules/data_initialization';\n\nvar App = /*#__PURE__*/function (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"getShopName\", function _callee(address) {\n      var s, shopName;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              s = Shop(address);\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(s.methods.shopName.call());\n\n            case 3:\n              shopName = _context.sent;\n              return _context.abrupt(\"return\", shopName);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderShops\", function () {\n      var items = _this.props.shops.map(function _callee2(address) {\n        return _regeneratorRuntime.async(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return _regeneratorRuntime.awrap(_this.getShopName(address));\n\n              case 2:\n                _context2.t0 = _context2.sent;\n                _context2.t1 = __jsx(Link, {\n                  route: \"shops/\".concat(address)\n                }, __jsx(\"a\", null, \"View Shops\"));\n                return _context2.abrupt(\"return\", {\n                  header: _context2.t0,\n                  description: _context2.t1,\n                  fluid: true\n                });\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        });\n      });\n\n      return __jsx(Card.Group, {\n        items: items\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClick\", function _callee3(event) {\n      var headers, _ref, data, status;\n\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              event.preventDefault();\n              headers = {\n                'Content-Type': 'application/json',\n                'x-auth-token': _this.props.headerToken\n              };\n              _context3.next = 4;\n              return _regeneratorRuntime.awrap(get('/user/login/me', headers));\n\n            case 4:\n              _ref = _context3.sent;\n              data = _ref.data;\n              status = _ref.status;\n              console.log(data);\n              console.log(status);\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      return __jsx(Layout, {\n        loggedIn: this.props.loggedIn,\n        headerToken: this.props.headerToken\n      }, __jsx(\"div\", null, this.renderShops(), __jsx(Button, {\n        onClick: this.onClick,\n        content: \"Create Shops\",\n        icon: \"add circle\",\n        primary: true\n      })), __jsx(\"div\", null, this.props.headerToken));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function getInitialProps(props) {\n      var shops, _validate, loggedIn, headerToken;\n\n      return _regeneratorRuntime.async(function getInitialProps$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _regeneratorRuntime.awrap(factory.methods.getDeployedShops().call());\n\n            case 2:\n              shops = _context4.sent;\n              _validate = validate(props.query.headerToken), loggedIn = _validate.loggedIn, headerToken = _validate.headerToken;\n              return _context4.abrupt(\"return\", {\n                shops: shops,\n                headerToken: headerToken,\n                loggedIn: loggedIn\n              });\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      });\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/home/zoro/Documents/Programming/JS/ration/ration-react/pages/index.js"],"names":["React","Component","Card","Button","factory","Layout","Link","get","validate","Shop","App","address","s","methods","shopName","call","items","props","shops","map","getShopName","header","description","fluid","event","preventDefault","headers","headerToken","data","status","console","log","loggedIn","renderShops","onClick","getDeployedShops","query"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAASC,IAAT,EAAeC,MAAf,QAA6B,mBAA7B;AACA,OAAOC,OAAP,MAAoB,qBAApB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,SAASC,IAAT,QAAqB,WAArB;AACA,OAAOC,GAAP,MAAgB,6BAAhB;AACA,OAAOC,QAAP,MAAqB,gCAArB;AACA,OAAOC,IAAP,MAAiB,kBAAjB,C,CACA;;IAEMC,G;;;;;;;;;;;;;;;;kEASY,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACJC,cAAAA,CADI,GACAH,IAAI,CAACE,OAAD,CADJ;AAAA;AAAA,+CAEaC,CAAC,CAACC,OAAF,CAAUC,QAAV,CAAmBC,IAAnB,EAFb;;AAAA;AAEJD,cAAAA,QAFI;AAAA,+CAGHA,QAHG;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;kEAOC,YAAM;AACjB,UAAME,KAAK,GAAG,MAAKC,KAAL,CAAWC,KAAX,CAAiBC,GAAjB,CAAqB,kBAAOR,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDAEZ,MAAKS,WAAL,CAAiBT,OAAjB,CAFY;;AAAA;AAAA;AAAA,+BAGb,MAAC,IAAD;AAAM,kBAAA,KAAK,kBAAWA,OAAX;AAAX,mBAAiC,8BAAjC,CAHa;AAAA;AAE3BU,kBAAAA,MAF2B;AAG3BC,kBAAAA,WAH2B;AAI3BC,kBAAAA,KAJ2B,EAInB;AAJmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAArB,CAAd;;AAQA,aAAO,MAAC,IAAD,CAAM,KAAN;AAAY,QAAA,KAAK,EAAEP;AAAnB,QAAP;AACH,K;;8DAES,kBAAOQ,KAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACNA,cAAAA,KAAK,CAACC,cAAN;AACMC,cAAAA,OAFA,GAEU;AACR,gCAAe,kBADP;AAER,gCAAiB,MAAKT,KAAL,CAAWU;AAFpB,eAFV;AAAA;AAAA,+CAOuBpB,GAAG,CAAC,gBAAD,EAAmBmB,OAAnB,CAP1B;;AAAA;AAAA;AAOCE,cAAAA,IAPD,QAOCA,IAPD;AAOOC,cAAAA,MAPP,QAOOA,MAPP;AAQNC,cAAAA,OAAO,CAACC,GAAR,CAAYH,IAAZ;AACAE,cAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;;AATM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;;;;;;6BAYD;AACL,aACI,MAAC,MAAD;AAAQ,QAAA,QAAQ,EAAE,KAAKZ,KAAL,CAAWe,QAA7B;AAAuC,QAAA,WAAW,EAAE,KAAKf,KAAL,CAAWU;AAA/D,SACI,mBACK,KAAKM,WAAL,EADL,EAEI,MAAC,MAAD;AACI,QAAA,OAAO,EAAE,KAAKC,OADlB;AAEI,QAAA,OAAO,EAAC,cAFZ;AAGI,QAAA,IAAI,EAAC,YAHT;AAII,QAAA,OAAO;AAJX,QAFJ,CADJ,EAUI,mBAAM,KAAKjB,KAAL,CAAWU,WAAjB,CAVJ,CADJ;AAeH;;;oCAtD4BV,K;;;;;;;;+CAELb,OAAO,CAACS,OAAR,CAAgBsB,gBAAhB,GAAmCpB,IAAnC,E;;;AAAdG,cAAAA,K;0BAC4BV,QAAQ,CAACS,KAAK,CAACmB,KAAN,CAAYT,WAAb,C,EAAlCK,Q,aAAAA,Q,EAAUL,W,aAAAA,W;gDACX;AAAET,gBAAAA,KAAK,EAALA,KAAF;AAASS,gBAAAA,WAAW,EAAXA,WAAT;AAAsBK,gBAAAA,QAAQ,EAARA;AAAtB,e;;;;;;;;;;;;EANG/B,S;;AA4DlB,eAAeS,GAAf","sourcesContent":["import React, {Component} from 'react';\nimport { Card, Button } from 'semantic-ui-react';\nimport factory from '../ethereum/factory';\nimport Layout from '../components/layout';\nimport { Link } from '../routes';\nimport get from '../localmodules/express_get';\nimport validate from '../localmodules/token_validate';\nimport Shop from '../ethereum/shop';\n// import jsonArray from '../localmodules/data_initialization';\n\nclass App extends Component {\n    \n    static async getInitialProps(props) {\n        //const address = props.query.address;\n        const shops = await factory.methods.getDeployedShops().call();\n        const { loggedIn, headerToken } = validate(props.query.headerToken);\n        return { shops, headerToken, loggedIn };\n    }\n    \n    getShopName = async (address) => {\n        const s = Shop(address);\n        const shopName = await s.methods.shopName.call(); \n        return shopName;\n    }\n\n\n    renderShops =  () => {\n        const items = this.props.shops.map(async (address) => {\n            return{\n                header : await this.getShopName(address),\n                description : <Link route={`shops/${address}`}><a>View Shops</a></Link>,\n                fluid : true\n            };\n        });\n\n        return <Card.Group items={items}/>;\n    }\n\n    onClick = async (event) => {\n        event.preventDefault();\n        const headers = { \n                'Content-Type':'application/json',\n                'x-auth-token' : this.props.headerToken\n        };\n\n        const {data, status} = await get('/user/login/me', headers);\n        console.log(data);\n        console.log(status);\n    }\n\n    render() {\n        return (\n            <Layout loggedIn={this.props.loggedIn} headerToken={this.props.headerToken}>\n                <div>\n                    {this.renderShops()}\n                    <Button\n                        onClick={this.onClick}\n                        content=\"Create Shops\"\n                        icon=\"add circle\"\n                        primary\n                    />\n                </div>\n                <div>{this.props.headerToken}</div>\n            </Layout>\n        );\n\n    }\n\n}\n\nexport default App;\n\n\n"]},"metadata":{},"sourceType":"module"}